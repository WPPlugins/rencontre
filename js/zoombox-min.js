var scr=document.getElementsByTagName("script");var zoombox_path=scr[scr.length-1].getAttribute("src").replace("zoombox.js","");(function(e){function k(){if(d=="closed")i=false;d="load";I();if(m.test(s)){img=new Image;img.src=s;e("body").append('<div id="zoombox_loader"></div>');e("#zoombox_loader").css("marginTop",U());a=window.setInterval(function(){D(img)},100)}else{_();O()}}function L(){e("body").append(v);e(window).keydown(function(e){F(e.which)});e(window).resize(function(){j()});e("#zoombox .zoombox_mask").hide();e("#zoombox").addClass(t.theme);e("#zoombox .zoombox_mask,.zoombox_close").click(function(){M();return false});if(p==false){e("#zoombox .zoombox_next,#zoombox .zoombox_prev").remove()}else{e("#zoombox .zoombox_next").click(function(){H()});e("#zoombox .zoombox_prev").click(function(){B()})}}function A(){var n=0;var r=0;var i=0;if(t.gallery){if(p===false){e("#zoombox .zoombox_gallery").remove();return false}for(var s in p){var o=zoombox_path+"img/video.png";var u=e('<img src="'+o+'" class="video gallery'+s*1+'"/>');if(m.test(p[s].attr("href"))){o=p[s].attr("href");u=e('<img src="'+o+'" class="gallery'+s*1+'"/>')}u.data("id",s).appendTo("#zoombox .zoombox_gallery");u.click(function(){P(e(this).data("id"));e("#zoombox .zoombox_gallery img").removeClass("current");e(this).addClass("current")});if(s==h){u.addClass("current")}e("<img/>").data("img",u).attr("src",o).load(function(){n++;var t=e(this).data("img");t.width(Math.round(t.height()*this.width/this.height));if(n==e("#zoombox .zoombox_gallery img").length){var r=0;e("#zoombox .zoombox_gallery img").each(function(){r+=e(this).outerWidth();e(this).data("left",r)});var s=e("<div>").css({position:"absolute",top:0,left:0,width:r});e("#zoombox .zoombox_gallery").wrapInner(s);i=e("#zoombox .zoombox_gallery").width();e("#zoombox").trigger("change")}})}e("#zoombox .zoombox_gallery").show().animate({bottom:0},t.duration)}e("#zoombox").bind("change",function(n,r){if(e("#zoombox .zoombox_gallery div").width()<e("#zoombox .zoombox_gallery").width){return true}var i=0;var s=0;if(r!=null){i=t.duration;s=r.width/2}else{s=e("#zoombox .zoombox_gallery").width()/2}var o=-e("#zoombox .zoombox_gallery img.current").data("left")+e("#zoombox .zoombox_gallery img.current").width()/2;var u=o+s;if(u<s*2-e("#zoombox .zoombox_gallery div").width()){u=s*2-e("#zoombox .zoombox_gallery div").width()}if(u>0){u=0}e("#zoombox .zoombox_gallery div").animate({left:u},i)})}function O(){if(i==false)L();else e("#zoombox .zoombox_title").empty();e("#zoombox .close").hide();e("#zoombox .zoombox_container").removeClass("multimedia").removeClass("img").addClass(c);if(r!=null&&r.attr("title")){e("#zoombox .zoombox_title").append(r.attr("title"))}e("#zoombox .zoombox_content").empty();if(c=="img"&&i==false&&t.animation==true){e("#zoombox .zoombox_content").append(l)}if(r!=null&&r.find("img").length!=0&&i==false){var n=r.find("img");e("#zoombox .zoombox_container").css({width:n.width(),height:n.height(),top:n.offset().top,left:n.offset().left,opacity:0,marginTop:n.css("marginTop")})}else if(r!=null&&i==false){e("#zoombox .zoombox_container").css({width:r.width(),height:r.height(),top:r.offset().top,left:r.offset().left})}else if(i==false){e("#zoombox .zoombox_container").css({width:100,height:100,top:q()/2-50,left:R()/2-50})}var s={width:o,height:u,left:(R()-o)/2,top:(q()-u)/2,marginTop:U(),opacity:1};e("#zoombox").trigger("change",s);if(t.animation==true){e("#zoombox .zoombox_title").hide();e("#zoombox .zoombox_close").hide();e("#zoombox .zoombox_container").animate(s,t.duration,function(){if(c=="multimedia"||i==true){e("#zoombox .zoombox_content").append(l)}if(c=="image"||i==true){e("#zoombox .zoombox_content img").css("opacity",0).fadeTo(300,1)}e("#zoombox .zoombox_title").fadeIn(300);e("#zoombox .zoombox_close").fadeIn(300);d="opened";if(!i){A()}i=true});e("#zoombox .zoombox_mask").fadeTo(200,t.opacity)}else{e("#zoombox .zoombox_content").append(l);e("#zoombox .zoombox_close").show();e("#zoombox .zoombox_gallery").show();e("#zoombox .zoombox_container").css(s);e("#zoombox .zoombox_mask").show();e("#zoombox .zoombox_mask").css("opacity",t.opacity);if(!i){A()}i=true;d="opened"}}function M(){d="closing";window.clearInterval(a);e(window).unbind("keydown");e(window).unbind("resize");if(c=="multimedia"){e("#zoombox .zoombox_container").empty()}var n={};if(r!=null&&r.find("img").length>0){var s=r.find("img");n={width:s.width(),height:s.height(),top:s.offset().top,left:s.offset().left,opacity:0,marginTop:s.css("marginTop")}}else if(r!=null){n={width:r.width(),height:r.height(),top:r.offset().top,left:r.offset().left,marginTop:0,opacity:0}}else{n={width:100,height:100,top:q()/2-50,left:R()/2-50,opacity:0}}if(t.animation==true){e("#zoombox .zoombox_mask").fadeOut(200);e("#zoombox .zoombox_gallery").animate({bottom:-e("#zoombox .zoombox_gallery").innerHeight()},t.duration);e("#zoombox .zoombox_container").animate(n,t.duration,function(){e("#zoombox").remove();d="closed";i=false})}else{e("#zoombox").remove();d="closed";i=false}}function _(){if(t.overflow==false){if(o*1+50>R()){u=(R()-50)*u/o;o=R()-50}if(u*1+50>q()){o=(q()-50)*o/u;u=q()-50}}var e=s;c="multimedia";if(m.test(e)){c="img";l='<img src="'+s+'" width="100%" height="100%"/>'}else if(g.test(e)){o=300;u=40;l='<object type="application/x-shockwave-flash" data="'+MP3Player+"?son="+e+'" width="'+o+'" height="'+u+'">';l+='<param name="movie" value="'+MP3Player+"?son="+e+'" /></object>'}else if(y.test(e)){var n=0;if(t.autoplay==true){n=1}l='<object type="application/x-shockwave-flash" data="'+zoombox_path+'FLVplayer.swf" width="'+o+'" height="'+u+'"><param name="allowFullScreen" value="true"><param name="scale" value="noscale"><param name="wmode" value="transparent"><param name="flashvars" value="flv='+e+"&autoplay="+n+'"><embed src="'+zoombox_path+'FLVplayer.swf" width="'+o+'" height="'+u+'" allowscriptaccess="always" allowfullscreen="true" flashvars="flv='+e+'" wmode="transparent" /></object>'}else if(b.test(e)){l='<object width="'+o+'" height="'+u+'"><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="'+e+'" /><embed src="'+e+'" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="'+o+'" height="'+u+'" wmode="transparent"></embed></object>'}else if(w.test(e)){l='<embed src="'+e+'" width="'+o+'" height="'+u+'" controller="true" cache="true" autoplay="true"/>'}else if(E.test(e)){l='<embed src="'+e+'" width="'+o+'" height="'+u+'" controller="true" cache="true" autoplay="true" wmode="transparent" />'}else if(S.test(e)){var r=e.split("_");r=r[0].split("/");r=r[r.length-1]+"?";if(t.autoplay==true){r=r+"autoPlay=1&"}l='<iframe frameborder="0" width="'+o+'" height="'+u+'" src="http://www.dailymotion.com/embed/video/'+r+'?wmode=transparent"></iframe>'}else if(x.test(e)){var r=e.split("/");r=r[3]+"?";if(t.autoplay==true){r=r+"autoplay=1&"}l='<iframe src="http://player.vimeo.com/video/'+r+'title=0&byline=0&portrait=0&wmode=transparent" width="'+o+'" height="'+u+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'}else if(T.test(e)){var r=e.split("watch?v=");r=r[1].split("&");r=r[0]+"?";if(t.autoplay==true){r=r+"autoplay=1&"}l='<iframe width="'+o+'" height="'+u+'" src="http://www.youtube.com/embed/'+r+'wmode=Opaque" frameborder="0" allowfullscreen></iframe>'}else if(N.test(e)){e=e.split(".html");e=e[0];l='<object type="application/x-shockwave-flash" data="'+e+'" width="'+o+'" height="'+u+'"><param name="movie" value="'+e+'"><embed src="'+e+'" type="application/x-shockwave-flash" width="'+o+'" height="'+u+'"  wmode="transparent"></embed></object>'}else{l='<iframe src="'+e+'" width="'+o+'" height="'+u+'" border="0"></iframe>'}return l}function D(t){if(t.complete){f=0;window.clearInterval(a);o=t.width;u=t.height;e("#zoombox_loader").remove();_();O()}e("#zoombox_loader").css({"background-position":"0px "+f+"px"});f=f-40;if(f<-440){f=0}}function P(t){if(d!="opened"){return false}h=t;r=p[h];s=r.attr("href");if(e("#zoombox .zoombox_gallery img").length>0){e("#zoombox .zoombox_gallery img").removeClass("current");e("#zoombox .zoombox_gallery img:eq("+t+")").addClass("current")}k();return false}function H(){f=h+1;if(f>p.length-1){f=0}P(f)}function B(){f=h-1;if(f<0){f=p.length-1}P(f)}function j(){e("#zoombox .zoombox_container").css({top:(q()-e("#zoombox .zoombox_container").outerHeight(true))/2,left:(R()-e("#zoombox .zoombox_container").outerWidth(true))/2})}function F(e){if(e==37){B()}if(e==39){H()}if(e==27){M()}}function I(){o=t.width;u=t.height;if(r!=null){var e=/w([0-9]+)/;var n=e.exec(r.attr("class"));if(n!=null){if(n[1]){o=n[1]}}var i=/h([0-9]+)/;var s=i.exec(r.attr("class"));if(s!=null){if(s[1]){u=s[1]}}}return false}function q(){if(window.innerHeight)return window.innerHeight;else{return e(window).height()}}function R(){if(window.innerWidth)return window.innerWidth;else{return e(window).width()}}function U(){scrOfY=0;if(typeof window.pageYOffset=="number"){scrOfY=window.pageYOffset}else if(document.body&&document.body.scrollTop){scrOfY=document.body.scrollTop}else if(document.documentElement&&document.documentElement.scrollTop){scrOfY=document.documentElement.scrollTop}return scrOfY}function z(){scrOfX=0;if(typeof window.pageXOffset=="number"){scrOfX=window.pageXOffset}else if(document.body&&document.body.scrollLeft){scrOfX=document.body.scrollLeft}else if(document.documentElement&&document.documentElement.scrollLeft){scrOfX=document.documentElement.scrollLeft}return scrOfX}var t={theme:"zoombox",opacity:.8,duration:800,animation:true,width:600,height:400,gallery:true,autoplay:false,overflow:false};var n;var r;var i=false;var s;var o;var u;var a;var f=0;var l;var c="multimedia";var h=false;var p=false;var d="closed";var v='<div id="zoombox">             <div class="zoombox_mask"></div>            <div class="zoombox_container">                <div class="zoombox_content"></div>                <div class="zoombox_title"></div>                <div class="zoombox_next"></div>                <div class="zoombox_prev"></div>                <div class="zoombox_close"></div>            </div>            <div class="zoombox_gallery"></div>        </div>';var m=/(\.jpg)|(\.jpeg)|(\.bmp)|(\.gif)|(\.png)/i;var g=/(\.mp3)/i;var y=/(\.flv)/i;var b=/(\.swf)/i;var w=/(\.mov)|(\.mp4)/i;var E=/(\.wmv)|(\.avi)/i;var S=/(http:\/\/www.dailymotion)|(http:\/\/dailymotion)/i;var x=/(http:\/\/www.vimeo)|(http:\/\/vimeo)/i;var T=/(youtube\.)/i;var N=/(http:\/\/www\.koreus)|(http:\/\/koreus)/i;var C=0;e.zoombox=function(e,t){};e.zoombox.options=t;e.zoombox.close=function(){M()};e.zoombox.open=function(n,i){r=null;s=n;t=e.extend({},e.zoombox.options,i);k()};e.zoombox.html=function(n,i){l=n;t=e.extend({},e.zoombox.options,i);o=t.width;u=t.height;r=null;O()};e.fn.zoombox=function(i){n=new Array;return this.each(function(){if(e.browser.msie&&e.browser.version<7&&!window.XMLHttpRequest){return false}var o=this;var u=/zgallery([0-9]+)/;var a=u.exec(e(this).attr("class"));var f=false;if(a!=null){if(!n[a[1]]){n[a[1]]=new Array}n[a[1]].push(e(this));var l=n[a[1]].length-1;f=n[a[1]]}e(this).unbind("click").click(function(){t=e.extend({},e.zoombox.options,i);if(d!="closed")return false;r=e(o);s=r.attr("href");p=f;h=l;k();return false})})}})(jQuery)